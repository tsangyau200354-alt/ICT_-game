<!DOCTYPE html>
<html lang="zh-HK">
<head>
<meta charset="UTF-8">
<title>資訊及通訊科技 S5 複習測驗</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body{
    font-family:"Microsoft JhengHei",Arial,sans-serif;
    background:linear-gradient(135deg,#e3f2fd,#bbdefb);
    margin:0;padding:20px;color:#333;
  }
  .wrap{
    max-width:960px;margin:auto;background:#fff;padding:30px;
    border-radius:16px;box-shadow:0 8px 30px rgba(0,0,0,.15);
  }
  h1{
    text-align:center;color:#0d47a1;margin:0 0 10px;font-size:28px;
  }
  .sub{
    text-align:center;color:#555;margin-bottom:25px;font-size:17px;
  }
  button{
    display:block;margin:25px auto;padding:14px 32px;
    background:#0d47a1;color:#fff;border:none;border-radius:10px;
    font-size:17px;cursor:pointer;font-weight:bold;transition:0.3s;
  }
  button:hover{background:#003087;}
  .q{
    margin:22px 0;padding:18px;border:1px solid #e0e0e0;
    border-radius:10px;background:#fafafa;
  }
  .opt label{
    display:block;padding:10px;margin:5px 0;cursor:pointer;
    border-radius:6px;transition:0.2s;
  }
  .opt label:hover{background:#e3f2fd;}
  .opt input{margin-right:10px;}
  .match{
    display:flex;justify-content:space-between;align-items:center;
    padding:14px;margin:12px 0;border:2px dashed #90caf9;
    border-radius:10px;background:#f5fbff;
  }
  .match select{
    padding:8px;border-radius:6px;border:1px solid #90caf9;min-width:220px;
  }
  .res{
    margin-top:12px;padding:12px;border-radius:8px;
    font-weight:bold;display:none;font-size:15px;
  }
  .ok{background:#d4edda;color:#155724;border:1px solid #c3e6cb;}
  .no{background:#f8d7da;color:#721c24;border:1px solid #f5c6cb;}
  #score{
    text-align:center;font-size:24px;margin:35px 0;padding:22px;
    background:linear-gradient(135deg,#e8f5e9,#c8e6c9);
    border-radius:14px;display:none;font-weight:bold;color:#2e7d32;
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>資訊及通訊科技</h1>
  <p class="sub">S5 第一學期複習測驗（第1課 + 第2課）<br>每次隨機生成 10 題選擇題 + 5 題連線題</p>
  <button onclick="newQuiz()">生成新測驗</button>

  <div id="quiz"></div>
  <div id="score"></div>
  <button id="chk" onclick="check()" style="display:none;background:#2e7d32;">提交答案</button>
</div>

<script>
/* ========== 100 MC + 20 MATCHING QUESTION BANK ========== */
const mc = [
  {q:"以下哪些是將無線滑鼠連接至電腦的常見方式？",o:["藍牙","USB 電線","2.4 GHz 射頻"],c:[0,2],e:"無線滑鼠使用藍牙或2.4GHz射頻；USB電線屬有線連接。"},
  {q:"以下哪項會影響掃描器掃描相片的質素？",o:["4800 dpi","支援 802.11n","JPEG 格式"],c:[0,2],e:"dpi 決定解像度；JPEG 為有損壓縮；Wi-Fi 與質素無關。"},
  {q:"電腦滑鼠相較觸控式屏幕的優點包括：",o:["價格較低","手眼協調配合更佳","文字輸入更快"],c:[1],e:"滑鼠操作更精準，手眼協調更好。"},
  {q:"關於磁帶卡和智能卡，哪項正確？",o:["磁帶卡較智能卡耐用","智能卡於微晶片儲存數據","智能卡較磁帶卡難複製"],c:[1,2],e:"智能卡使用晶片，安全性高且難以複製。"},
  {q:"激光打印機相較噴墨打印機的優點包括：",o:["遇水不模糊","墨盒不堵塞","影像持久存放"],c:[0,1],e:"噴墨易模糊、易堵塞；兩者影像均可持久。"},
  {q:"以下部件必定能在電腦主機內找到？",o:["RAM","硬碟","獨立圖形卡"],c:[0],e:"RAM 為必需；硬碟可被SSD取代；iGPU可取代獨立顯卡。"},
  {q:"關於 CPU 和 GPU，哪一項正確？",o:["CPU 不可處理圖像","GPU 一定有專屬RAM","GPU 可整合至CPU","CPU 無需散熱"],c:[2],e:"iGPU 即整合在CPU內的圖形處理器。"},
  {q:"哪種系統匯流排負責傳送控制訊號？",o:["通用串列匯流排","數據匯流排","控制匯流排","PCIe 匯流排"],c:[2],e:"控制匯流排傳送控制訊號給各部件。"},
  {q:"機器周期中，哪個寄存器儲存「下一個指令的位址」？",o:["CIR","PC","MAR","MDR"],c:[1],e:"PC（程式計數器）儲存下一條指令的記憶體位址。"},
  {q:"RAM 的主要特點是：",o:["非易失性","數據於關機後消失","比ROM快","不可重寫"],c:[1],e:"RAM 為易失性記憶體，關機後數據消失。"},
  {q:"以下哪種輸入設備屬於「自動輸入設備」？",o:["鍵盤","條碼掃描器","顯示器","揚聲器"],c:[1],e:"條碼掃描器可自動讀取資料，無需人手輸入。"},
  {q:"OCR 技術的主要用途是：",o:["壓縮圖像","將掃描圖像轉為文字","增強相片顏色","列印文件"],c:[1],e:"OCR = 光學字符識別，將圖像轉為可編輯文字。"},
  {q:"MIDI 鍵盤與普通麥克風輸入音頻的區別是：",o:["MIDI 受環境噪音影響","MIDI 輸入模擬聲波","MIDI 輸入數碼音符","MIDI 無法錄音"],c:[2],e:"MIDI 傳送音符數據，不受噪音影響。"},
  {q:"以下哪種打印機使用「感熱紙」？",o:["噴墨打印機","激光打印機","感熱式打印機","3D 打印機"],c:[2],e:"感熱式打印機加熱感熱紙成像，常見於收據。"},
  {q:"POS 終端機通常包含以下哪項設備？",o:["投影機","條碼掃描器","遊戲手制","耳機"],c:[1],e:"POS 用於結帳，需掃描條碼。"},
  {q:"以下哪種儲存設備屬於「固態儲存」？",o:["磁帶","硬碟","SSD","光碟"],c:[2],e:"SSD 使用快閃記憶體，無移動部件。"},
  {q:"ROM 主要用來儲存：",o:["用戶檔案","BIOS 啟動程式","正在處理的數據","遊戲存檔"],c:[1],e:"ROM 儲存韌體，開機時使用。"},
  {q:"CPU 時鐘頻率越高，通常代表：",o:["耗電越少","運算速度越慢","運算速度越快","核心數量越多"],c:[2],e:"時鐘頻率決定每秒執行指令次數。"},
  {q:"快取記憶體的主要作用是：",o:["長期儲存檔案","暫存常用數據以加快存取","備份系統","顯示圖像"],c:[1],e:"快取比RAM快，用來提升效率。"},
  {q:"以下哪種匯流排用於連接外部設備？",o:["系統匯流排","控制匯流排","USB 匯流排","位址匯流排"],c:[2],e:"USB 是通用串列匯流排，連接鍵盤、滑鼠等。"},
  {q:"RAID 技術的主要好處包括：",o:["增加螢幕尺寸","提升數據傳輸速度","降低打印成本","增強語音輸入"],c:[1],e:"RAID 提升速度與資料安全性。"},
  {q:"雲端儲存與本地硬碟的最大分別是：",o:["雲端需付費","雲端可隨時隨地存取","雲端容量較小","雲端速度較慢"],c:[1],e:"雲端透過網路存取，需網際網路。"},
  {q:"以下哪種設備屬於「視像輸入設備」？",o:["顯示器","網絡攝影機","打印機","揚聲器"],c:[1],e:"網絡攝影機用於視像會議，輸入影片。"},
  {q:"智能卡與磁帶卡的主要區別是：",o:["智能卡用磁場讀取","智能卡用微晶片儲存","智能卡較便宜","智能卡容量較小"],c:[1],e:"智能卡內建晶片，安全性高。"},
  {q:"GPU 適合用於人工智能訓練，因為它：",o:["核心數量少","可並行處理大量簡單運算","耗電量低","體積小"],c:[1],e:"AI 需要同時處理大量數據，GPU 擅長並行運算。"},
  {q:"以下哪種記憶體屬於「非易失性」？",o:["RAM","快取記憶體","ROM","寄存器"],c:[2],e:"ROM 關機後仍保留數據。"},
  {q:"機器周期的四個階段依次是：",o:["提取→執行→譯碼→儲存","提取→譯碼→執行→儲存","儲存→提取→執行→譯碼","譯碼→儲存→提取→執行"],c:[1],e:"標準馮紐曼架構：Fetch→Decode→Execute→Store。"},
  {q:"以下哪種設備可用於「3D 掃描」？",o:["平板掃描器","數碼相機","3D 掃描器","投影機"],c:[2],e:"3D 掃描器生成物件的數碼3D模型。"},
  {q:"自助借書終端機通常包含：",o:["條碼掃描器","遊戲手制","耳機","繪圖儀"],c:[0],e:"掃描書籍條碼以借還。"},
  {q:"以下哪項是「輸出設備」？",o:["鍵盤","麥克風","揚聲器","滑鼠"],c:[2],e:"揚聲器輸出聲音，屬輸出設備。"},
  {q:"以下哪種設備屬於「定點設備」？",o:["麥克風","滑鼠","打印機","顯示器"],c:[1],e:"滑鼠用於點擊、拖曳等互動。"},
  {q:"感熱式打印機的主要缺點是：",o:["速度慢","成本高","紙張遇熱變色","無法列印彩色"],c:[2],e:"感熱紙遇熱會變黑，長期保存不佳。"},
  {q:"以下哪種儲存設備使用「順序存取」？",o:["硬碟","SSD","磁帶","記憶卡"],c:[2],e:"磁帶需從頭讀取，屬順序存取。"},
  {q:"USB 3.0 與 USB 2.0 相比的主要優勢是：",o:["傳輸速度更快","支援無線","價格更低","耗電更少"],c:[0],e:"USB 3.0 傳輸速率達 5Gbps。"},
  {q:"以下哪種設備可用於「生物識別」？",o:["條碼掃描器","指紋掃描器","投影機","揚聲器"],c:[1],e:"指紋掃描器讀取身體特徵。"},
  {q:"CPU 字長為 64 位元，代表它一次可處理：",o:["64 位元數據","64 個指令","64 個核心","64 個寄存器"],c:[0],e:"字長決定單次處理的位元數。"},
  {q:"以下哪種打印機適合列印「向量圖」？",o:["噴墨打印機","激光打印機","繪圖儀","3D 打印機"],c:[2],e:"繪圖儀使用筆精確繪製向量圖。"},
  {q:"視像會議系統通常需要：",o:["麥克風 + 網絡攝影機","鍵盤 + 滑鼠","打印機 + 掃描器","揚聲器 + 顯示器"],c:[0],e:"需輸入語音與影像。"},
  {q:"以下哪種記憶體速度最快？",o:["RAM","快取記憶體","SSD","硬碟"],c:[1],e:"快取記憶體最接近CPU。"},
  {q:"NAS 設備的主要功能是：",o:["列印文件","網絡儲存與共享","播放音樂","掃描圖像"],c:[1],e:"NAS = 網絡附加儲存。"},
  {q:"以下哪項不屬於「輸入設備」？",o:["鍵盤","滑鼠","顯示器","麥克風"],c:[2],e:"顯示器是輸出設備。"},
  {q:"二維碼（QR Code）與條碼的主要區別是：",o:["QR Code 只能存數字","QR Code 可存更多資料","QR Code 無法掃描","QR Code 較便宜"],c:[1],e:"QR Code 可儲存文字、網址等。"},
  {q:"以下哪種設備使用「激光」讀取資料？",o:["硬碟","光碟機","SSD","記憶卡"],c:[1],e:"光碟機用激光讀取凹槽。"},
  {q:"CPU 核心數量越多，通常代表：",o:["耗電越少","多工處理能力越強","時鐘頻率越高","字長越長"],c:[1],e:"多核心可同時執行多個任務。"},
  {q:"以下哪種儲存設備容量最大？",o:["USB 隨身碟","SSD","硬碟","磁帶"],c:[3],e:"磁帶用於備份，容量可達數十TB。"},
  {q:"顯示器的「更新率」以何單位量度？",o:["dpi","Hz","ppi","bit"],c:[1],e:"更新率以赫茲（Hz）表示。"},
  {q:"以下哪種設備屬於「音頻輸入」？",o:["揚聲器","耳機","MIDI 鍵盤","麥克風"],c:[3],e:"麥克風記錄聲音。"},
  {q:"以下哪種打印機列印速度最快？",o:["噴墨","激光","感熱","繪圖儀"],c:[1],e:"激光打印機適合大量列印。"},
  {q:"控制部件（CU）的主要功能是：",o:["執行算術運算","控制指令執行流程","儲存數據","顯示圖像"],c:[1],e:"CU 協調ALU與記憶體。"},
  {q:"以下哪種記憶體屬於「易失性」？",o:["ROM","快閃記憶體","RAM","光碟"],c:[2],e:"RAM 關機後資料消失。"},
  {q:"POS 系統中，「P」代表：",o:["打印","支付","銷售點","電源"],c:[2],e:"POS = Point of Sale。"},
  {q:"以下哪種設備可用於「自助結帳」？",o:["條碼掃描器","耳機","繪圖儀","投影機"],c:[0],e:"掃描商品條碼。"},
  {q:"GPU 的 RAM 與主機 RAM 的區別是：",o:["GPU RAM 速度較慢","GPU RAM 專用於圖像處理","GPU RAM 容量較大","GPU RAM 非易失性"],c:[1],e:"VRAM 專供圖形運算。"},
  {q:"以下哪種儲存設備最耐用？",o:["硬碟","SSD","磁帶","光碟"],c:[1],e:"SSD 無移動部件，抗震。"},
  {q:"以下哪種匯流排傳送「記憶體位址」？",o:["數據匯流排","控制匯流排","位址匯流排","USB"],c:[2],e:"位址匯流排指定讀寫位置。"},
  {q:"3D 打印機列印的物件是：",o:["2D 圖像","實體立體模型","聲音","動畫"],c:[1],e:"根據3D模型層層堆疊。"},
  {q:"以下哪種設備屬於「位置追蹤定點設備」？",o:["滑鼠","觸控板","遊戲手制","觸控筆"],c:[3],e:"觸控筆直接在螢幕上定位。"},
  {q:"以下哪項是「輸入 - 處理 - 輸出」循環的第一步？",o:["處理數據","輸出資訊","輸入數據","儲存結果"],c:[2],e:"IPO 循環從輸入開始。"},
  {q:"以下哪種打印機成本最低？",o:["激光","噴墨","感熱","3D"],c:[2],e:"感熱紙便宜，適合收據。"},
  {q:"以下哪種設備用於「遠程會議」？",o:["打印機","網絡攝影機","掃描器","揚聲器"],c:[1],e:"網絡攝影機傳送視像。"},
  {q:"以下哪種記憶體用於「啟動電腦」？",o:["RAM","ROM","SSD","快取"],c:[1],e:"ROM 儲存 BIOS。"},
  {q:"以下哪種設備屬於「動作追蹤定點設備」？",o:["觸控筆","滑鼠","觸控板","軌跡球"],c:[3],e:"軌跡球靠滾動追蹤動作。"},
  {q:"以下哪種儲存設備最便攜？",o:["硬碟","SSD","USB 隨身碟","磁帶"],c:[2],e:"USB 隨身碟小巧易攜。"},
  {q:"以下哪種打印機可列印「實體模型」？",o:["噴墨","激光","感熱","3D 打印機"],c:[3],e:"3D 打印機製造立體物件。"},
  {q:"以下哪項不屬於「顯示器規格」？",o:["解像度","更新率","色深","墨水容量"],c:[3],e:"墨水容量屬打印機規格。"},
  {q:"以下哪種設備用於「語音識別」？",o:["揚聲器","麥克風","顯示器","打印機"],c:[1],e:"麥克風輸入語音。"},
  {q:"以下哪種儲存設備使用「快閃記憶體」？",o:["硬碟","SSD","光碟","磁帶"],c:[1],e:"SSD 核心為快閃記憶體。"},
  {q:"以下哪種匯流排屬於「系統匯流排」？",o:["USB","PCIe","SATA","HDMI"],c:[1],e:"PCIe 連接內部高速設備。"},
  {q:"以下哪種設備屬於「圖像輸入」？",o:["顯示器","數碼相機","打印機","揚聲器"],c:[1],e:"數碼相機捕捉影像。"},
  {q:"以下哪種打印機「每頁成本最低」？",o:["噴墨","激光","感熱","3D"],c:[1],e:"激光打印機耗材經濟。"},
  {q:"以下哪種記憶體「存取速度最快」？",o:["RAM","快取","SSD","硬碟"],c:[1],e:"快取最接近CPU。"},
  {q:"以下哪種設備用於「掃描指紋」？",o:["條碼掃描器","生物識別設備","投影機","揚聲器"],c:[1],e:"生物識別讀取身體特徵。"},
  {q:"以下哪種儲存設備「不可重寫」？",o:["CD-ROM","SSD","USB 隨身碟","硬碟"],c:[0],e:"CD-ROM 為唯讀。"},
  {q:"以下哪種設備屬於「輸出設備」？",o:["鍵盤","滑鼠","投影機","麥克風"],c:[2],e:"投影機輸出影像。"},
  {q:"以下哪種打印機「不受水影響」？",o:["噴墨","激光","感熱","3D"],c:[1],e:"激光使用碳粉，不怕水。"},
  {q:"以下哪種設備用於「自助借書」？",o:["條碼掃描器","耳機","繪圖儀","遊戲手制"],c:[0],e:"掃描書籍條碼。"},
  {q:"以下哪種記憶體「容量最小」？",o:["RAM","ROM","快取","寄存器"],c:[3],e:"寄存器僅數十位元。"},
  {q:"以下哪種設備屬於「有線連接」？",o:["藍牙滑鼠","USB 鍵盤","Wi-Fi 打印機","2.4GHz 滑鼠"],c:[1],e:"USB 為有線。"},
  {q:"以下哪種打印機「最安靜」？",o:["噴墨","激光","感熱","3D"],c:[2],e:"感熱無機械聲。"},
  {q:"以下哪種設備用於「列印保養單據」？",o:["感熱","噴墨","激光","繪圖儀"],c:[2],e:"激光適合正式文件。"},
  {q:"以下哪種儲存設備「最耐撞」？",o:["硬碟","SSD","光碟","磁帶"],c:[1],e:"SSD 無移動部件。"},
  {q:"以下哪種匯流排「傳送數據」？",o:["控制匯流排","位址匯流排","數據匯流排","電源匯流排"],c:[2],e:"數據匯流排傳送實際資料。"},
  {q:"以下哪種設備屬於「音頻輸出」？",o:["麥克風","MIDI 鍵盤","揚聲器","數碼相機"],c:[2],e:"揚聲器播放聲音。"},
  {q:"以下哪種打印機「墨盒易堵塞」？",o:["激光","噴墨","感熱","3D"],c:[1],e:"噴墨長時間不用會堵塞。"},
  {q:"以下哪種設備用於「視像串流」？",o:["顯示器","網絡攝影機","掃描器","打印機"],c:[1],e:"網絡攝影機直播影像。"},
  {q:"以下哪種記憶體「用於暫存指令」？",o:["ROM","RAM","快取","硬碟"],c:[2],e:"快取暫存常用指令。"},
  {q:"以下哪種設備屬於「自動輸入」？",o:["鍵盤","二維碼掃描器","滑鼠","觸控板"],c:[1],e:"二維碼掃描器自動讀取。"},
  {q:"以下哪種打印機「適合列印照片」？",o:["激光","噴墨","感熱","繪圖儀"],c:[1],e:"噴墨色彩鮮艷。"},
  {q:"以下哪種設備用於「遠程教學」？",o:["網絡攝影機","打印機","掃描器","揚聲器"],c:[0],e:"視像會議需攝影機。"},
  {q:"以下哪種記憶體「關機後保留數據」？",o:["RAM","快取","ROM","寄存器"],c:[2],e:"ROM 為非易失性。"},
  {q:"以下哪種設備屬於「位置追蹤」？",o:["滑鼠","觸控筆","軌跡球","遊戲手制"],c:[1],e:"觸控筆直接定位。"},
  {q:"以下哪種儲存設備「最便宜每GB」？",o:["SSD","硬碟","USB 隨身碟","磁帶"],c:[1],e:"硬碟性價比高。"},
  {q:"以下哪種打印機「列印速度最慢」？",o:["噴墨","激光","感熱","3D"],c:[3],e:"3D 需層層堆疊。"},
  {q:"以下哪種設備用於「掃描文件」？",o:["數碼相機","平板掃描器","投影機","揚聲器"],c:[1],e:"平板掃描器掃描紙本。"},
  {q:"以下哪種記憶體「用於圖像處理」？",o:["RAM","VRAM","ROM","快取"],c:[1],e:"VRAM 專供GPU使用。"},
  {q:"以下哪種設備屬於「輸入與輸出結合」？",o:["鍵盤","耳機麥克風","顯示器","打印機"],c:[1],e:"耳機有麥克風與揚聲器。"},
  {q:"以下哪種儲存設備「需驅動器」？",o:["SSD","內建硬碟","外接光碟","USB 隨身碟"],c:[2],e:"光碟需光碟機。"},
  {q:"以下哪種匯流排「連接顯示器」？",o:["USB","HDMI","SATA","PCIe"],c:[1],e:"HDMI 傳送影音。"},
  {q:"以下哪種設備用於「列印海報」？",o:["A4 激光","A3 噴墨","感熱","繪圖儀"],c:[3],e:"繪圖儀適合大幅面。"},
  {q:"以下哪種記憶體「容量最大」？",o:["寄存器","快取","RAM","ROM"],c:[2],e:"RAM 通常數GB。"},
  {q:"以下哪種設備屬於「感應器」？",o:["溫度計","滑鼠","鍵盤","顯示器"],c:[0],e:"溫度計感測環境變化。"},
  {q:"以下哪種打印機「無墨水」？",o:["噴墨","激光","感熱","3D"],c:[2],e:"感熱靠加熱成像。"},
  {q:"以下哪種設備用於「博物館導覽」？",o:["資訊站觸控屏","打印機","掃描器","揚聲器"],c:[0],e:"觸控屏提供互動資訊。"},
  {q:"以下哪種記憶體「用於啟動程式」？",o:["RAM","ROM","SSD","快取"],c:[1],e:"ROM 儲存 BIOS。"},
  {q:"以下哪種設備屬於「動作追蹤」？",o:["觸控筆","滑鼠","觸控板","軌跡球"],c:[3],e:"軌跡球靠滾動追蹤。"},
  {q:"以下哪種儲存設備「最慢」？",o:["SSD","硬碟","磁帶","RAM"],c:[2],e:"磁帶為順序存取。"},
  {q:"以下哪種打印機「最貴」？",o:["噴墨","激光","3D","感熱"],c:[2],e:"3D 打印機價格高。"},
  {q:"以下哪種設備用於「掃描虹膜」？",o:["條碼掃描器","生物識別設備","投影機","揚聲器"],c:[1],e:"虹膜掃描屬生物識別。"}
];

const match = [
  ["條碼掃描器","掃描產品條碼轉為數字序列"],
  ["MIDI 鍵盤","輸入數碼音樂，不受噪音干擾"],
  ["OCR","將掃描圖像轉為可編輯文字"],
  ["GPU","適合AI訓練，因可並行處理"],
  ["快取記憶體","比RAM更快，暫存常用數據"],
  ["控制匯流排","傳送控制訊號給各部件"],
  ["iGPU","整合在CPU內的圖形處理器"],
  ["POS 終端機","商店結帳系統，含條碼掃描器"],
  ["RAID","多個硬碟組合，提升速度與安全性"],
  ["雲端儲存","透過互聯網存取數據"],
  ["感熱式打印機","使用感熱紙，適合列印收據"],
  ["3D 打印機","根據數碼模型列印實體物件"],
  ["網絡攝影機","串流視像，常用於視像會議"],
  ["生物識別設備","掃描指紋、臉部或虹膜"],
  ["USB 快閃記憶體","小巧便攜，屬固態儲存"],
  ["光學標記閱讀器","掃描特定符號，如選舉票"],
  ["位址匯流排","傳送記憶體位置給部件"],
  ["數據匯流排","在CPU與部件間傳送實際數據"],
  ["NAS","網絡附加儲存，供多用戶共享"],
  ["VRAM","專供GPU使用的圖像記憶體"]
];

/* ========== QUIZ STATE ========== */
let cur = {mc:[],mt:[]};

/* ========== GENERATE ========== */
function newQuiz(){
  document.getElementById("quiz").innerHTML="";
  document.getElementById("score").style.display="none";
  document.getElementById("chk").style.display="none";

  // 隨機抽 10 題選擇題
  const mcShuf = [...mc].sort(()=>0.5-Math.random()).slice(0,10);
  cur.mc = mcShuf.map((x,i)=>({...x,id:`m${i}`}));

  // 隨機抽 5 組連線題
  const mtShuf = [...match].sort(()=>0.5-Math.random()).slice(0,5);
  const left = mtShuf.map(p=>p[0]);
  const right = mtShuf.map(p=>p[1]);
  const rightRand = [...right].sort(()=>0.5-Math.random());
  cur.mt = left.map((l,i)=>({l, r:rightRand[i], c:mtShuf.find(p=>p[0]===l)[1]}));

  render();
}

function render(){
  let h = "<h2>多項選擇題 (10題)</h2>";
  cur.mc.forEach((q,i)=>{
    const multi = q.c.length>1;
    h+=`<div class="q"><p><strong>${i+1}. ${q.q}</strong></p><div class="opt">`;
    q.o.forEach((t,j)=>{
      h+=`<label><input type="${multi?'checkbox':'radio'}" name="m${i}" value="${j}"> ${t}</label>`;
    });
    h+=`</div><div id="r${q.id}" class="res"></div></div>`;
  });

  h+="<h2>連線題 (5組)</h2>";
  cur.mt.forEach((p,i)=>{
    h+=`<div class="match"><strong>${p.l}</strong><select id="s${i}"><option value="">-- 選擇 --</option>`;
    cur.mt.forEach(x=>h+=`<option value="${x.r}">${x.r}</option>`);
    h+=`</select></div><div id="rm${i}" class="res"></div>`;
  });

  document.getElementById("quiz").innerHTML = h;
  document.getElementById("chk").style.display="block";
}

/* ========== CHECK ========== */
function check(){
  let correct=0, total=cur.mc.length+cur.mt.length;

  // 檢查選擇題
  cur.mc.forEach((q,i)=>{
    const sel = Array.from(document.querySelectorAll(`input[name="m${i}"]:checked`)).map(el=>+el.value);
    const ans = q.c.slice().sort((a,b)=>a-b);
    const ok = sel.length===ans.length && sel.every((v,j)=>v===ans[j]);
    const el = document.getElementById(`r${q.id}`);
    el.style.display="block";
    if(ok){
      el.textContent="正確！ "+q.e;
      el.className="res ok";
      correct++;
    }else{
      el.textContent=`錯誤。正解：${ans.map(x=>q.o[x]).join(", ")}。${q.e}`;
      el.className="res no";
    }
  });

  // 檢查連線題
  cur.mt.forEach((p,i)=>{
    const sel = document.getElementById(`s${i}`).value;
    const el = document.getElementById(`rm${i}`);
    el.style.display="block";
    if(sel===p.c){
      el.textContent="配對正確！";
      el.className="res ok";
      correct++;
    }else{
      el.textContent=`錯誤。正解：${p.c}`;
      el.className="res no";
    }
  });

  // 顯示總分
  const sc = document.getElementById("score");
  sc.style.display="block";
  sc.innerHTML=`<strong>得分：${correct} / ${total} （${Math.round(correct/total*100)}%）</strong><br>
                <button onclick="newQuiz()" style="margin-top:12px;">再試一次</button>`;
}

/* ========== START ========== */
window.onload = newQuiz;
</script>
</body>
</html>