<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è»Ÿä»¶åˆ†é¡åµæ¢éŠæˆ²</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f0f8ff; text-align: center; padding: 20px; }
        h1 { color: #007bff; }
        #game { max-width: 1000px; margin: 0 auto; }
        #results { max-width: 1000px; margin: 0 auto; display: none; background: #d4edda; padding: 20px; border-radius: 8px; }
        .category { border: 2px dashed #007bff; margin: 10px; padding: 10px; min-height: 60px; background: white; border-radius: 8px; display: inline-block; width: 180px; vertical-align: top; }
        .category.dragover { border-color: #28a745; background: #d4edda; }
        .item { display: inline-block; background: #ffc107; margin: 5px; padding: 8px; border-radius: 5px; cursor: grab; user-select: none; }
        .item:active { cursor: grabbing; }
        #items { margin: 20px 0; }
        #score { font-size: 24px; color: #28a745; }
        #timer { font-size: 20px; color: #dc3545; }
        button { background: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 10px; }
        button:hover { background: #0056b3; }
        button:disabled { background: #6c757d; cursor: not-allowed; }
        .feedback { font-weight: bold; margin: 10px; }
        .correct { color: #28a745; }
        .wrong { color: #dc3545; }
        #final-score { font-size: 28px; color: #28a745; margin: 20px 0; }
    </style>
</head>
<body>
    <div id="game">
        <h1>ğŸ•µï¸â€â™‚ï¸ è»Ÿä»¶åˆ†é¡åµæ¢éŠæˆ²</h1>
        <p>æ‹–æ‹½ä¾‹å­åˆ°æ­£ç¢ºé¡åˆ¥ï¼æ“ä½œç³»çµ±ã€å¯¦ç”¨ç¨‹å¼ã€é©…å‹•ç¨‹å¼ï¼Œä»¥åŠæ‡‰ç”¨è»Ÿä»¶çš„å››ç¨®é¡å‹ï¼šç”Ÿç”¢åŠ›è»Ÿä»¶ã€é€šè¨Šè»Ÿä»¶ã€åª’é«”é–‹ç™¼è»Ÿä»¶ã€æ•™è‚²è»Ÿä»¶ã€‚å®Œæˆå¾—é«˜åˆ†ï¼</p>
        <div id="timer">æ™‚é–“ï¼š90 ç§’</div>
        <div id="score">åˆ†æ•¸ï¼š0 / 40</div>
        <div id="feedback" class="feedback"></div>
        
        <div id="categories">
            <div class="category" data-type="os">æ“ä½œç³»çµ±<br>å¦‚ Windows</div>
            <div class="category" data-type="utility">å¯¦ç”¨ç¨‹å¼<br>å¦‚é˜²æ¯’</div>
            <div class="category" data-type="driver">é©…å‹•ç¨‹å¼<br>å¦‚å°è¡¨æ©Ÿ</div>
            <div class="category" data-type="productivity">ç”Ÿç”¢åŠ›è»Ÿä»¶<br>å¦‚ Word</div>
            <div class="category" data-type="communication">é€šè¨Šè»Ÿä»¶<br>å¦‚ç€è¦½å™¨</div>
            <div class="category" data-type="media">åª’é«”é–‹ç™¼è»Ÿä»¶<br>å¦‚ Photoshop</div>
            <div class="category" data-type="educational">æ•™è‚²è»Ÿä»¶<br>å¦‚ PowerPoint</div>
        </div>
        
        <div id="items">
            <!-- ä¾‹å­æœƒç”¨ JS å‹•æ…‹ç”¢ç”Ÿ -->
        </div>
        
        <button id="startBtn" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
        <button id="resetBtn" onclick="resetGame()" disabled>é‡ç©</button>
    </div>

    <div id="results">
        <h1>ğŸ‰ éŠæˆ²çµæœ</h1>
        <p>è¨˜ä½ï¼Œæ“ä½œç³»çµ±çµ±ç±Œä¸€åˆ‡ï¼Œå¯¦ç”¨ç¨‹å¼èˆ‡é©…å‹•ç¨‹å¼æ˜¯å¹•å¾Œè‹±é›„ï¼Œæ‡‰ç”¨è»Ÿä»¶æå‡æ•ˆç‡èˆ‡æ¨‚è¶£ï¼</p>
        <div id="final-score">æ­£ç¢ºæ•¸ï¼š0 / 40</div>
        <button onclick="backToGame()">è¿”å›éŠæˆ²</button>
    </div>

    <script>
        const categories = ['os', 'utility', 'driver', 'productivity', 'communication', 'media', 'educational'];
        const itemsData = [
            // æ“ä½œç³»çµ± (4 å€‹)
            { text: 'Windows 11', type: 'os' },
            { text: 'macOS', type: 'os' },
            { text: 'Linux', type: 'os' },
            { text: 'Android', type: 'os' },
            // å¯¦ç”¨ç¨‹å¼ (8 å€‹)
            { text: 'æª”æ¡ˆç®¡ç†å“¡', type: 'utility' },
            { text: 'ZIP å£“ç¸®å·¥å…·', type: 'utility' },
            { text: 'é˜²æ¯’è»Ÿä»¶', type: 'utility' },
            { text: 'ç£ç¢Ÿæ¸…ç†', type: 'utility' },
            { text: 'è¨˜æ†¶é«”ç®¡ç†', type: 'utility' },
            { text: 'ç³»çµ±é‚„åŸ', type: 'utility' },
            { text: 'å‚™ä»½å·¥å…·', type: 'utility' },
            { text: 'é˜²ç«ç‰†', type: 'utility' },
            // ç”Ÿç”¢åŠ›è»Ÿä»¶ (8 å€‹)
            { text: 'Microsoft Word', type: 'productivity' },
            { text: 'Excel è©¦ç®—è¡¨', type: 'productivity' },
            { text: 'Evernote', type: 'productivity' },
            { text: 'OneNote', type: 'productivity' },
            { text: 'Trello', type: 'productivity' },
            { text: 'Google Docs', type: 'productivity' },
            { text: 'LibreOffice Writer', type: 'productivity' },
            { text: 'Notion', type: 'productivity' },
            // é€šè¨Šè»Ÿä»¶ (5 å€‹)
            { text: 'Google Chrome', type: 'communication' },
            { text: 'Zoom', type: 'communication' },
            { text: 'Microsoft Teams', type: 'communication' },
            { text: 'Skype', type: 'communication' },
            { text: 'Discord', type: 'communication' },
            // åª’é«”é–‹ç™¼è»Ÿä»¶ (5 å€‹)
            { text: 'Photoshop', type: 'media' },
            { text: 'Notepad++', type: 'media' },
            { text: 'Audacity', type: 'media' },
            { text: 'Visual Studio Code', type: 'media' },
            { text: 'Figma', type: 'media' },
            // æ•™è‚²è»Ÿä»¶ (5 å€‹)
            { text: 'PowerPoint', type: 'educational' },
            { text: 'Kahoot', type: 'educational' },
                { text: 'Science calculator', type: 'educational' },
            { text: 'Quizlet', type: 'educational' },
            { text: 'Scratch', type: 'educational' },
            // é©…å‹•ç¨‹å¼ (5 å€‹)
            { text: 'é¡¯ç¤ºå¡é©…å‹•', type: 'driver' },
            { text: 'å°è¡¨æ©Ÿé©…å‹•', type: 'driver' },
            { text: 'éŸ³æ•ˆå¡é©…å‹•', type: 'driver' },
            { text: 'USB é©…å‹•', type: 'driver' },
            { text: 'ç¶²è·¯å¡é©…å‹•', type: 'driver' }
        ];

        let score = 0;
        let timeLeft = 90;
        let gameActive = false;
        let timerId;
        let draggedItem = null;
        const totalItems = itemsData.length; // 40

        function shuffle(array) {
            return array.sort(() => Math.random() - 0.5);
        }

        function startGame() {
            if (gameActive) return;
            gameActive = true;
            score = 0;
            timeLeft = 90;
            updateScore();
            updateTimer();
            document.getElementById('startBtn').disabled = true;
            document.getElementById('resetBtn').disabled = false;
            document.getElementById('results').style.display = 'none';
            document.getElementById('game').style.display = 'block';
            timerId = setInterval(() => {
                timeLeft--;
                updateTimer();
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
            const shuffledItems = shuffle([...itemsData]);
            const itemsDiv = document.getElementById('items');
            itemsDiv.innerHTML = shuffledItems.map(item => 
                `<div class="item" draggable="true" data-type="${item.type}">${item.text}</div>`
            ).join('');
            document.getElementById('feedback').innerHTML = '';
            addDragListeners();
        }

        function resetGame() {
            clearInterval(timerId);
            gameActive = false;
            document.getElementById('items').innerHTML = '';
            categories.forEach(cat => {
                document.querySelector(`[data-type="${cat}"]`).innerHTML = 
                    categoriesData[cat].label + '<br><small>æ‹–æ‹½é€™è£¡</small>';
            });
            updateScore();
            updateTimer();
            document.getElementById('feedback').innerHTML = '';
            document.getElementById('startBtn').disabled = false;
            document.getElementById('resetBtn').disabled = true;
            document.getElementById('game').style.display = 'block';
            document.getElementById('results').style.display = 'none';
        }

        function backToGame() {
            resetGame();
        }

        function endGame() {
            clearInterval(timerId);
            gameActive = false;
            document.getElementById('startBtn').disabled = false;
            document.getElementById('resetBtn').disabled = false;
            const items = document.querySelectorAll('.item');
            items.forEach(item => {
                item.draggable = false;
            });
            const cats = document.querySelectorAll('.category');
            cats.forEach(cat => {
                cat.style.pointerEvents = 'none';
            });
            document.getElementById('game').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            document.getElementById('final-score').textContent = `æ­£ç¢ºæ•¸ï¼š${score} / ${totalItems}`;
        }

        function updateScore() {
            document.getElementById('score').textContent = `åˆ†æ•¸ï¼š${score} / ${totalItems}`;
        }

        function updateTimer() {
            document.getElementById('timer').textContent = `æ™‚é–“ï¼š${timeLeft} ç§’`;
        }

        const categoriesData = {
            os: { label: 'æ“ä½œç³»çµ±' },
            utility: { label: 'å¯¦ç”¨ç¨‹å¼' },
            driver: { label: 'é©…å‹•ç¨‹å¼' },
            productivity: { label: 'ç”Ÿç”¢åŠ›è»Ÿä»¶' },
            communication: { label: 'é€šè¨Šè»Ÿä»¶' },
            media: { label: 'åª’é«”é–‹ç™¼è»Ÿä»¶' },
            educational: { label: 'æ•™è‚²è»Ÿä»¶' }
        };

        function addDragListeners() {
            const items = document.querySelectorAll('.item');
            items.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    if (!gameActive) return;
                    draggedItem = item;
                    e.dataTransfer.effectAllowed = 'move';
                });
            });

            const cats = document.querySelectorAll('.category');
            cats.forEach(cat => {
                cat.addEventListener('dragover', (e) => {
                    if (!gameActive) return;
                    e.preventDefault();
                    cat.classList.add('dragover');
                    e.dataTransfer.dropEffect = 'move';
                });
                cat.addEventListener('dragleave', () => cat.classList.remove('dragover'));
                cat.addEventListener('drop', (e) => {
                    if (!gameActive) return;
                    e.preventDefault();
                    cat.classList.remove('dragover');
                    if (draggedItem && draggedItem.parentNode) {
                        const itemType = draggedItem.dataset.type;
                        const catType = cat.dataset.type;
                        if (itemType === catType) {
                            cat.appendChild(draggedItem);
                            score++;
                            updateScore();
                            document.getElementById('feedback').innerHTML = '<span class="correct">âœ… æ­£ç¢ºï¼+1 åˆ†</span>';
                        } else {
                            document.getElementById('feedback').innerHTML = '<span class="wrong">âŒ éŒ¯äº†ï¼è©¦è©¦å…¶ä»–é¡åˆ¥</span>';
                        }
                        if (document.querySelectorAll('#items .item').length === 0) {
                            setTimeout(endGame, 1000);
                        }
                    }
                });
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            categories.forEach(cat => {
                document.querySelector(`[data-type="${cat}"]`).innerHTML = 
                    categoriesData[cat].label + '<br><small>æ‹–æ‹½é€™è£¡</small>';
            });
        });
    </script>
</body>
</html>
